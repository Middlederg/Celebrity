@page "/subcategories/create"

@inject SubcategoryRepository repository
@inject NavigationManager navigationManager

<div class="container">

    <div class="card border-0">
        <div class="card-body">
            <h1 class="display-4 text-dark text-center mb-4">Create subcategory</h1>

            <EditForm Model="@model" OnValidSubmit="@HandleValidSubmit">

                <div class="form mt-4">
                    <DataAnnotationsValidator />

                    <div class="form-group row">
                        <label for="category-selector" class="col-sm-2 col-form-label">Category</label>
                        <div class="col-sm-10">
                            @*<CategoryCombo></CategoryCombo>*@
                        </div>
                    </div>
                    <div class="form-group row mb-4">
                        <label for="subcategoryName" class="col-sm-2 col-form-label">Name</label>
                        <div class="col-sm-10">
                            <InputText @bind-Value="name"
                                       class="form-control"
                                       placeholder="Name" />
                        </div>
                    </div>

                    <div class="d-flex justify-content-end mt-4">
                        <button class="btn btn-outline-secondary btn-lg mr-2" @onclick="GoToIndex">
                            <span class="oi oi-chevron-left mr-2 small"
                                  title="back to the categories list"
                                  aria-hidden="true">
                            </span>
                            Back
                        </button>

                        <button type="submit" class="btn btn-success btn-lg">
                            <span class="oi oi-check mr-2 small" title="add new subcategory" aria-hidden="true"></span>
                            Create
                        </button>
                    </div>
                </div>
            </EditForm>
        </div>
    </div>
</div>

@code {

    private string name;
    private CategoryValue category;
    private Celebrity.Shared.CreateSubcategory model = new Celebrity.Shared.CreateSubcategory()

protected override void OnInitialized()
    {
        model = new Celebrity.Shared.CreateSubcategory()
        {
            Category = CategoryValue.RealCharacters
        };
    }

    private async Task HandleValidSubmit()
    {
        var subcategory = await repository.Create(model);
        navigationManager.NavigateTo($"subcategories/details/{subcategory.Id}");
    }

    private void GoToIndex()
    {
        navigationManager.NavigateTo("subcategories");
    }
}
